















<!doctype html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta http-equiv="last-modified" content="2021-10-22 13:57:41 +0100">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <!-- meta "search-domain" used for google site search function google_search() -->
    <meta name="search-domain" value="">
    <link rel="stylesheet" type="text/css" href="../assets/css/bootstrap.css" />
    <link rel="stylesheet" type="text/css" href="../assets/css/bootstrap-theme.css" />
    <link rel="stylesheet" type="text/css" href="../assets/css/lesson.css" />
    <link rel="stylesheet" type="text/css" href="../assets/css/syntax.css" />

    



    <!-- Favicons for everyone -->
    <link rel="apple-touch-icon-precomposed" sizes="57x57" href="../assets/favicons/swc/apple-touch-icon-57x57.png" />
    <link rel="apple-touch-icon-precomposed" sizes="114x114" href="../assets/favicons/swc/apple-touch-icon-114x114.png" />
    <link rel="apple-touch-icon-precomposed" sizes="72x72" href="../assets/favicons/swc/apple-touch-icon-72x72.png" />
    <link rel="apple-touch-icon-precomposed" sizes="144x144" href="../assets/favicons/swc/apple-touch-icon-144x144.png" />
    <link rel="apple-touch-icon-precomposed" sizes="60x60" href="../assets/favicons/swc/apple-touch-icon-60x60.png" />
    <link rel="apple-touch-icon-precomposed" sizes="120x120" href="../assets/favicons/swc/apple-touch-icon-120x120.png" />
    <link rel="apple-touch-icon-precomposed" sizes="76x76" href="../assets/favicons/swc/apple-touch-icon-76x76.png" />
    <link rel="apple-touch-icon-precomposed" sizes="152x152" href="../assets/favicons/swc/apple-touch-icon-152x152.png" />
    <link rel="icon" type="image/png" href="../assets/favicons/swc/favicon-196x196.png" sizes="196x196" />
    <link rel="icon" type="image/png" href="../assets/favicons/swc/favicon-96x96.png" sizes="96x96" />
    <link rel="icon" type="image/png" href="../assets/favicons/swc/favicon-32x32.png" sizes="32x32" />
    <link rel="icon" type="image/png" href="../assets/favicons/swc/favicon-16x16.png" sizes="16x16" />
    <link rel="icon" type="image/png" href="../assets/favicons/swc/favicon-128.png" sizes="128x128" />
    <meta name="application-name" content="Software Carpentry - Group Projects"/>
    <meta name="msapplication-TileColor" content="#FFFFFF" />
    <meta name="msapplication-TileImage" content="../assets/favicons/swc/mstile-144x144.png" />
    <meta name="msapplication-square70x70logo" content="../assets/favicons/swc/mstile-70x70.png" />
    <meta name="msapplication-square150x150logo" content="../assets/favicons/swc/mstile-150x150.png" />
    <meta name="msapplication-wide310x150logo" content="../assets/favicons/swc/mstile-310x150.png" />
    <meta name="msapplication-square310x310logo" content="../assets/favicons/swc/mstile-310x310.png" />


    <!-- HTML5 shim and Respond.js for IE8 support of HTML5 elements and media queries -->
    <!-- WARNING: Respond.js doesn't work if you view the page via file:// -->
    <!--[if lt IE 9]>
	<script src="https://oss.maxcdn.com/html5shiv/3.7.2/html5shiv.min.js"></script>
	<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
	<![endif]-->
  <script type="text/x-mathjax-config">
  MathJax.Hub.Config({
    tex2jax: {
      inlineMath: [['$','$'], ['\\(','\\)']],
      processEscapes: true
    }
  });
  </script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.0/MathJax.js?config=TeX-AMS-MML_HTMLorMML" type="text/javascript"></script>

  <title>
  Pharmokinetics Modelling Project &ndash; Group Projects
  </title>  

  </head>
  <body>

    


<div class="panel panel-default life-cycle">
  <div id="life-cycle" class="panel-body beta">
    This lesson is being piloted (Beta version)
  </div>
</div>




    <div class="container">
      






<nav class="navbar navbar-default">
  <div class="container-fluid">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#bs-example-navbar-collapse-1" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>

      
      
      <a href="https://software-carpentry.org" class="pull-left">
        <img class="navbar-logo" src="../assets/img/sabs-logo.png" alt="Software Carpentry logo" />
      </a>
      

      
      <a class="navbar-brand" href="../index.html">Home</a>

    </div>
    <div class="collapse navbar-collapse" id="bs-example-navbar-collapse-1">
      <ul class="nav navbar-nav">

        
        
        <li class="dropdown">
          <a href="../" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-haspopup="true" aria-expanded="false">Episodes <span class="caret"></span></a>
          <ul class="dropdown-menu">
            
            <li><a href="../01-introduction/index.html">Pharmokinetics Modelling Project</a></li>
            
	    <li role="separator" class="divider"></li>
            <li><a href="../aio/index.html">All in one page (Beta)</a></li>
          </ul>
        </li>
	

	
        <li><a href="../LICENSE.html">License</a></li>
      </ul>
      <form class="navbar-form navbar-right" role="search" id="search" onsubmit="google_search(); return false;">
        <div class="form-group">
          <input type="text" id="google-search" placeholder="Search..." aria-label="Google site search">
        </div>
      </form>
    </div>
  </div>
</nav>

















<div class="row">
  <div class="col-xs-1">
    <h3 class="text-left">
      
      <a href="../"><span class="glyphicon glyphicon-menu-up" aria-hidden="true"></span><span class="sr-only">lesson home</span></a>
      
    </h3>
  </div>
  <div class="col-xs-10">
    
    <h3 class="maintitle"><a href="../">Group Projects</a></h3>
    
  </div>
  <div class="col-xs-1">
    <h3 class="text-right">
      
      <a href="../"><span class="glyphicon glyphicon-menu-up" aria-hidden="true"></span><span class="sr-only">lesson home</span></a>
      
    </h3>
  </div>
</div>

<article>
<div class="row">
  <div class="col-md-1">
  </div>
  <div class="col-md-10">
    <h1 class="maintitle">Pharmokinetics Modelling Project</h1>
  </div>
  <div class="col-md-1">
  </div>
</div>


<blockquote class="objectives">
  <h2>Overview</h2>

  <div class="row">
    <div class="col-md-3">
      <strong>Teaching:</strong> 30 min
      <br/>
      <strong>Exercises:</strong> 0 min
    </div>
    <div class="col-md-9">
      <strong>Questions</strong>
      <ul>
	
	<li><p>What is the project you will be working on?</p>
</li>
	
	<li><p>How will the group projects work?</p>
</li>
	
      </ul>
    </div>
  </div>

  <div class="row">
    <div class="col-md-3">
    </div>
    <div class="col-md-9">
      <strong>Objectives</strong>
      <ul>
	
	<li><p>Explain the background and the project you will be doing for the next 3 days.</p>
</li>
	
	<li><p>How each group will work together.</p>
</li>
	
	<li><p>Assessment deliverables</p>
</li>
	
      </ul>
    </div>
  </div>

</blockquote>

<h1 id="pharmokinetic-modelling">Pharmokinetic Modelling</h1>

<p>The field of Pharmacokinetics (PK) provides a quantitative basis for describing the 
delivery of a drug to a patient, the diffusion of that drug through the plasma/body 
tissue, and the subsequent clearance of the drug from the patient’s system. PK is used 
to ensure that there is sufficient concentration of the drug to maintain the required 
efficacy of the drug, while ensuring that the concentration levels remain below the 
toxic threshold (See Fig 1). Pharmacokinetic (PK) models are often combined with 
Pharmacodynamic (PD) models, which model the positive effects of the drug, such as the 
binding of a drug to the biological target, and/or undesirable side effects, to form a 
full PKPD model of the drug-body interaction. This project will only focus on PK, 
neglecting the interaction with a PD model.</p>

<p><img src="../fig/pk1.jpg" alt="Fig 1" width="700" /></p>

<p>PK enables the following processes to be quantified:</p>

<ul>
  <li>Absorption</li>
  <li>Distribution</li>
  <li>Metabolism</li>
  <li>Excretion</li>
</ul>

<p>These are often referred to as ADME, and taken together describe the drug concentration 
in the body when medicine is prescribed. These ADME processes are typically described by 
zeroth-order or first-order <em>rate</em> reactions modelling the dynamics of the quantity of 
drug $q$, with a given rate parameter $k$, for example:</p>

\[\frac{dq}{dt} = -k^*,\]

\[\frac{dq}{dt} = -k q.\]

<p>The body itself is modelled as one or more <em>compartments</em>, each of which is defined as a 
kinetically homogeneous unit (these compartments do not relate to specific organs in the 
body, unlike Physiologically based pharmacokinetic, PBPK, modeling). There is typically 
a main <em>central</em> compartment into which the drug is administered and from which the drug 
is excreted from the body, combined with zero or more <em>peripheral</em> compartments to 
which the drug can be distributed to/from the central compartment (See Fig 2). Each 
peripheral compartment is only connected to the central compartment.</p>

<p><img src="../fig/pk2.svg" alt="Fig 2" width="400" /></p>

<p>The following example PK model describes the two-compartment model shown diagrammatically 
in Fig 2. The time-dependent variables to be solved are the drug quantity in the central 
and peripheral compartments, $q_c$ and $q_{p1}$ (units: [ng]) respectively.</p>

\[\frac{dq_c}{dt} = \text{Dose}(t) - \frac{q_c}{V_c} CL 
- Q_{p1} \left ( \frac{q_c}{V_c} - \frac{q_{p1}}{V_{p1}} \right ),\]

\[\frac{dq_{p1}}{dt} =  Q_{p1} \left ( \frac{q_c}{V_c} - \frac{q_{p1}}{V_{p1}} \right ).\]

<p>This model describes an <em>intravenous bolus</em> dosing protocol, with a linear clearance 
from the central compartment (non-linear clearance processes are also possible, but not 
considered here). The input parameters to the model are:</p>
<ul>
  <li>The dose function $\text{Dose}(t)$, which could consist of instantaneous doses of $X$ 
ng of the drug at one or more time points, or a steady application of $X$ ng per hour 
over a given time period, or some combination.</li>
  <li>$V_c$ [mL], the volume of the central compartment</li>
  <li>$V_{p1}$ [mL], the volume of the first peripheral compartment</li>
  <li>$V_{p1}$ [mL], the volume of the peripheral compartment 1</li>
  <li>$CL$ [mL/h], the clearance/elimination rate from the central compartment</li>
  <li>$Q_{p1}$ [mL/h], the transition rate between central compartment and peripheral 
compartment 1</li>
</ul>

<p>Another example model we will show uses <em>subcutaneous</em> dosing, and adds an additional 
compartment from which the drug is absorbed to the central compartment:</p>

\[\frac{dq_0}{dt} = \text{Dose}(t) - k_a q_0,\]

\[\frac{dq_c}{dt} = k_a q_0  - \frac{q_c}{V_c} CL 
- Q_{p1} \left ( \frac{q_c}{V_c} - \frac{q_{p1}}{V_{p1}} \right ),\]

\[\frac{dq_{p1}}{dt} =  Q_{p1} \left ( \frac{q_c}{V_c} - \frac{q_{p1}}{V_{p1}} \right ),\]

<p>where $k_a$ [/h] is the “absorption” rate for the s.c dosing.</p>

<blockquote class="challenge">
  <h2 id="project-description">Project Description</h2>

  <p>Your group project is to design and implement a python library that can specify, solve 
and visualise the solution of a PK model. You might find it helpful to base this on a 
“starter” repository which you can clone from 
<a href="https://github.com/sabs-r3/software-engineering-projects-pk">https://github.com/sabs-r3/software-engineering-projects-pk</a>. 
This contains a basic Python script that constructs a two-compartment PK model with 
i.v. dosing, solves it using the Scipy 
<a href="https://docs.scipy.org/doc/scipy/reference/generated/scipy.integrate.solve_ivp.html"><code class="language-plaintext highlighter-rouge">solve_ivp</code></a> 
ODE solver, and then plots the results using <a href="https://matplotlib.org/"><code class="language-plaintext highlighter-rouge">Matplotlib</code></a>. 
It also contains the framework of a basic python package that can be installed using 
<code class="language-plaintext highlighter-rouge">pip</code>. This package uses the <code class="language-plaintext highlighter-rouge">unittest</code> testing framework, and defines a few classes 
<code class="language-plaintext highlighter-rouge">Model</code>, <code class="language-plaintext highlighter-rouge">Protocol</code>, and <code class="language-plaintext highlighter-rouge">Solution</code>. Note that you can feel free to use as much or as 
little of this template repository as you like, it is a suggestion based on a specific 
set of design decisions, and many other choices could be equal or superior to those 
chosen in the provided template.
Your PK modelling library should ideally have the following functionality:</p>
  <ul>
    <li>pip installable</li>
    <li>github repository, with issues + PRs that fully document the development process</li>
    <li>unit testing with a good test coverage</li>
    <li>fully documented, e.g. README,  API documentation, OS license</li>
    <li>continuous integration (e.g. Github actions) for automatic testing and documentation 
generation</li>
    <li>The ability to specify the form of the PK model, including the number of peripheral 
  compartments, the type of dosing (intravenous bolus versus subcutaneous), and the 
  dosing protocol.</li>
    <li>Users can specify the protocol independently from the model (e.g. be 
  able to solve a one and two compartment model for the same dosing protocol)</li>
    <li>Ability to solve for the drug quantity in each compartment over time, given a model 
and a protocol</li>
    <li>Ability to visualise the solution of a model, and to compare two different 
  solutions.</li>
    <li>Something else? Feel free to suggest alternative features.</li>
  </ul>

</blockquote>

<blockquote class="callout">
  <h2 id="numerical-solution-of-odes-using-scipy">Numerical solution of ODEs using Scipy</h2>

  <p>In the starter template, Scipy’s 
<a href="https://docs.scipy.org/doc/scipy/reference/generated/scipy.integrate.solve_ivp.html"><code class="language-plaintext highlighter-rouge">solve_ivp</code></a> 
is used to solve the set of ODEs that define the PK model. Since we are using linear PK, 
we could have used analytical solutions, but relying on an ODE solver allows us to be 
more flexible if we wish to include non-linear models in the future. In addition, you 
will need to be able to numerically solve ODE models for the Mathematical Modelling 
module in weeks 6-7, so take this time to become familiar with how to use <code class="language-plaintext highlighter-rouge">solve_ivp</code>.</p>
</blockquote>

<h2 id="structure-of-the-project-days">Structure of the project days</h2>

<p>Each project team is free to organise their interaction according to what works best for 
the group. You are free to meet as a group in the DTC, and each group will be assigned a 
student room in the building. Each group will also have a breakout room to meet 
virtually if required. Each group should create issues on their repository corresponding 
to individual work items, and assign these members of the group. Each group should 
identify a workflow that they will use to add code to the repository (e.g. one branch 
per issue, then a pull request once the work is ready to add to the main branch).</p>

<h2 id="hand-in">Hand-in</h2>

<p>Nothing needs to be physically handed-in for this assessment other than a URL for the 
GitHub repository for each group. Your feedback and assessment for the software 
engineering module will be based on this repository: the source code contained within, 
the generated documentation, and the content of the issues and pull requests. The source 
code should conform to a consistent style throughout, and docstrings &amp; comments should 
be appropriate so that the code can be easily read and understood. The documentation 
should be sufficient so that a new user could easily use the library. The issues and 
pull requests should be sufficiently detailed so that a developer could join the project 
half-way through and get up-to-speed on the current state of development and what needs 
to be done.</p>



<blockquote class="keypoints">
  <h2>Key Points</h2>
  <ul>
    
    <li><p>The groups will be identical to the SABS year-long open source software groups.</p>
</li>
    
    <li><p>Project management will consist of (at least) daily stand-ups and the use of GitHub issues and pull requests.</p>
</li>
    
    <li><p>Submit your GitHub repository for assessment by 5:30pm Friday 22nd October.</p>
</li>
    
  </ul>
</blockquote>

</article>
















<div class="row">
  <div class="col-xs-1">
    <h3 class="text-left">
      
      <a href="../"><span class="glyphicon glyphicon-menu-up" aria-hidden="true"></span><span class="sr-only">lesson home</span></a>
      
    </h3>
  </div>
  <div class="col-xs-10">
    
  </div>
  <div class="col-xs-1">
    <h3 class="text-right">
      
      <a href="../"><span class="glyphicon glyphicon-menu-up" aria-hidden="true"></span><span class="sr-only">lesson home</span></a>
      
    </h3>
  </div>
</div>


      
      






<footer>
  <div class="row">
    <div class="col-md-6 copyright" align="left">
<!--
	
	Licensed under <a href="https://creativecommons.org/licenses/by/4.0/">CC-BY 4.0</a> 2018–2021
	by <a href="https://carpentries.org/">The Carpentries</a>
        <br>
        Licensed under <a href="https://creativecommons.org/licenses/by/4.0/">CC-BY 4.0</a> 2016–2018
	by <a href="https://software-carpentry.org">Software Carpentry Foundation</a>
	
-->
    </div>
    <div class="col-md-6 help-links" align="right">
	<a href="/blob//CITATION" data-checker-ignore>Cite</a>
	/
	<a href="mailto:martin.robinson@cs.ox.ac.uk">Contact</a>
    </div>
  </div>
  <div class="row">
    <div class="col-md-12" align="center">
      Using <a href="https://github.com/carpentries/styles/">The Carpentries style</a>
      version <a href="https://github.com/carpentries/styles/releases/tag/v9.5.3">9.5.3</a>.
    </div>
  </div>
</footer>

      
    </div>
    
<script src="../assets/js/jquery.min.js"></script>
<script src="../assets/js/bootstrap.min.js"></script>
<script src="../assets/js/lesson.js"></script>
<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');
  ga('create', 'UA-37305346-2', 'auto');
  ga('send', 'pageview');
</script>

  </body>
</html>
